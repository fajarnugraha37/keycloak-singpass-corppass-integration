import"../modulepreload-polyfill-B5Qt9EMX.js";/* empty css                */import{s as n,l as o,h as c,c as s}from"../sched-DruKi8Dd.js";async function i(){const t=await fetch("/ids/auth/refresh",{method:"POST",credentials:"include"});if(t.ok){const{access_token:e,refresh_token:a}=await t.json();return window.localStorage.setItem("access_token",e),window.localStorage.setItem("refresh_token",a),window.localStorage.setItem("is_authenticated","true"),!0}else return window.localStorage.removeItem("access_token"),window.localStorage.removeItem("refresh_token"),window.localStorage.setItem("is_authenticated","false"),!1}window.onload=async()=>{n();let t=!1;try{if(!await i()){o("out","State: not authenticated, please login"),window.location.hash.includes("switcher")?(console.log("Switching"),location.href="/ids/auth/login"):t=!0;return}o("out","Authenticated.");var e=setInterval(async()=>{if(!await i()){o("out","State: not authenticated, clearing interval"),clearInterval(e);return}},6e4);t=!0}catch(a){console.error(a),o("out","Init error: "+a)}finally{t&&c()}};document.getElementById("login").onclick=()=>{n(),location.href="/ids/auth/login"};document.getElementById("logout").onclick=()=>{n(),location.href="/ids/auth/logout"};document.getElementById("userinfo").onclick=async()=>{if(!(window.localStorage.getItem("is_authenticated")==="true"&&window.localStorage.getItem("access_token")))return o("out","Not logged in");const e=await fetch("/ids/me",{credentials:"include",headers:{Authorization:"Bearer "+window.localStorage.getItem("access_token")}});o("out","userinfo: "+JSON.stringify(await e.json(),null,2))};document.getElementById("callapi").onclick=async()=>{if(!(window.localStorage.getItem("is_authenticated")==="true"&&window.localStorage.getItem("access_token")))return o("out","Not logged in");const e=await s("/cpds/api/hello",window.localStorage.getItem("access_token"));o("out",`CPDS API [${e.status}]:
${e.body}`)};document.getElementById("switch").onclick=()=>{window.location.href="/aceas/#switcher"};
